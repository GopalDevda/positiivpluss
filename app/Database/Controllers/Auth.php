<?phpnamespace App\Controllers;use App\Controllers\BaseController;use CodeIgniter\Controller;use App\Models\LoginModel;class Auth extends BaseController{    public $LoginModel;    public $session;    public function __construct(){        helper(['form', 'url']);        $this->LoginModel = new LoginModel();        $session = \Config\Services::session();    }        public function index(){        echo view('login');    }    public function adminlogin(){    	helper(['form','url']);        $session = \Config\Services::session();        $model = new LoginModel();        if($this->request->getMethod()== 'post')		{ 		$input= $this->validate([			'email' => 'required|valid_email',			'password' => 'required',		]);		if($input == true){        $email = $this->request->getVar('email');        $password = $this->request->getVar('password');        $data = $model->where('email', $email)->first();                if($data){                    $pass = $data['password'];                    $verify_pass = password_verify($password, $pass);                            if($verify_pass){                                $ses_data = [                                    'id'       => $data['id'],                                    'email'     => $data['email'],                                    'logged_in'     => TRUE                                ];                                $session->set('user_info',$ses_data);                                return redirect()->to('admin/home');                            }else{                                $session->setFlashdata('error', 'Wrong Password');                                return redirect()->to('auth/');                            }                }else{                    $session->setFlashdata('error', 'Email not Found');                    return redirect()->to('auth/');                }        	}else{				$data['validation']=$this->validator;			}        }        $session->setFlashdata('error', 'Email not Found');        return redirect()->to('auth/');    }      function logout(){ 		$this->session->destroy();		return redirect()->to('auth');	}} 